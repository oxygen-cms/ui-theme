{"version":3,"sources":["util.js","Core/Dialog.js","Core/Dropdown.js","Core/EditableList.js","Core/Fetch.js","Core/Form.js","Core/MainNav.js","Core/Notification.js","Core/Preferences.js","Core/Slider.js","Core/SmoothState.js","Core/TabSwitcher.js","Core/Toggle.js","Core/Upload.js","Editor/CodeViewInterface.js","Editor/DesignViewInterface.js","Editor/Editor.js","Editor/PreviewInterface.js","Editor/SplitViewInterface.js","ImageEditor/ImageEditor.js","login.js","app.js"],"names":["parentMatchingSelector","elem","selector","document","parentNode","matchesSelector","parentOrSelfMatchingSelector","NodeList","prototype","Symbol","iterator","Array","HTMLCollection","matchesMethod","ElemProto","Element","matches","prefixes","i","length","method","this","Dialog","container","_step","_iterator","_createForOfIteratorHelper","querySelectorAll","s","n","done","value","addEventListener","handleConfirmClick","err","e","f","_step2","_iterator2","handleAlertClick","event","vex","dialog","alert","currentTarget","getAttribute","customConfig","target","defaultConfig","attribute","preventDefault","stopPropagation","stopImmediatePropagation","message","callback","setAttribute","click","confirm","Dropdown","handleGlobalClick","classes","dropdownToggle","handleClick","c","classList","contains","dropdown","querySelector","dropdownList","isActive","remove","reset","add","EditableList","getElementsByClassName","handleAdd","handleRemove","template2","template","cloneNode","appendChild","row","removeChild","console","log","window","Oxygen","FetchOptions","_classCallCheck","headers","Headers","set","type","body","credentials","cookies","respond","text","response","json","checkStatus","ok","error","Error","notification","data","Notification","isNotification","NotificationCenter","present","redirect","smoothState","hardRedirect","load","location","replace","handleAPIError","Response","then","content","status","file","line","Form","element","form","originalData","getFormData","contentGenerators","registerEvents","item","formObject","$","find","taggableInput","tagging","edit-on-delete","handleKeydown","ctrlKey","metaKey","which","forms","getElementsByTagName","submitOnKeydown","submit","_this","warnBeforeExit","handleExit","handleSubmit","submitAsyncOnChange","submitAsync","autoSubmit","_this2","generateContent","original","current","compareByValue","messages","confirmation","buttons","className","$vexContent","close","id","extend","NO","_step3","_iterator3","generator","disableAsync","ignoreRedirectResponse","_this3","promise","fetch","action","getFormDataObject","wantJson","modifyPromise","undefined","_step4","_iterator4","checked","name","dir","_step5","_iterator5","options","option","selected","push","ref","files","filesToUpload","endsWith","formData","FormData","key","_step6","_iterator6","append","obj1","obj2","p","hasOwnProperty","_typeof","toString","altKey","controlKey","MainNav","header","innerWidth","headroom","Headroom","tolerance","offset","initial","pinned","unpinned","top","notTop","init","notifications","registerHide","hideAfter","setTimeout","hide","auto","clearTimeout","node","JSON","stringify","createElement","innerHTML","obj","Preferences","preferences","o","fallback","arguments","isDefined","parts","split","l","pop","Slider","list","selectors","items","interval","previousId","currentId","nextId","animating","animationTime","next","play","slider","back","previous","bind","forward","timer","setInterval","clearInterval","isHidden","shouldAnimate","getItem","hideAll","slideOutLeft","slideInRight","slideOutRight","slideInLeft","isCurrent","isAfter","noTransition","SmoothState","loading","anchors","root","cacheLength","onStart","duration","render","onProgress","onReady","onAfter","scrollTop","elements","blocks","slice","call","reverse","_loop","block","setCursor","style","display","html","_loop2","getElementById","url","mode","cursor","links","theme","page","TabSwitcher","tabs","findDefault","tab","setTo","forEach","active","Toggle","toggle","enableCallback","disableCallback","handleToggle","ifEnabled","ifDisabled","FullscreenToggle","fullscreenElement","enterFullscreenCallback","exitFullscreenCallback","_super","enterFullscreen","exitFullscreen","documentElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","mozCancelFullScreen","webkitExitFullscreen","Upload","uploadElement","dropzone","dropzoneElement","handleDragOver","handleDragLeave","handleDrop","handleChange","states","onDragOver","upload","addFiles","dataTransfer","input","preview","fileSize","size","insertBefore","firstChild","removeFile","button","index","previewElement","indexOf","splice","recalculateDropzoneVisibility","test","reader","FileReader","onload","backgroundImage","result","readAsDataURL","icon","multiple","sizeInBytes","approx","multiples","output","toFixed","CodeViewInterface","editor","ace","object","edit","getSession","setMode","language","setTheme","get","setUseWrapMode","setHighlightActiveLine","setShowPrintMargin","setShowInvisibles","setReadOnly","readOnly","view","fontSize","full","Editor","state","width","resize","setValue","textarea","getValue","DesignViewInterface","ck","config","allowedContent","entities","protectedSource","contentsCss","stylesheets","CKEDITOR","dtd","$removeEmpty","on","setData","getData","currentMode","handleSwitchEditor","handleFormSubmit","modes","fullscreenToggle","show","resizeToContent","editors","user","defaultMode","switchEditor","valueToForm","m","getMode","code","design","PreviewInterface","SplitViewInterface","create","valueFromForm","height","rows","resizeToContainer","trace","editorToSwitch","footer","contentIsSplit","_token","srcdoc","synchronize","currentTimer","ImageEditor","jCropApi","cropDisableCounter","cropOrigin","x","y","image","layout","$image","simple","advanced","fields","crop","keepAspectRatio","macro","slug","imageAspectRatio","naturalWidth","naturalHeight","enableCropping","toggleFullscreen","apply","handlePreview","save","handleSave","handleCropInputChange","handleResizeInputChange","applyChanges","gatherData","progressNotification","getSimpleData","getAdvancedData","removeDefaultFields","defaults","fit[position]","resize[width]","resize[height]","resize[keepAspectRatio]","gamma","greyscale","invert","rotate[backgroundColor]","crop[x]","pendingCropOrigin","parseInt","crop[y]","parse","applyingChanges","serializeToQueryString","blob","myBlob","destroy","objectURL","URL","createObjectURL","removeProperty","src","r","that","Jcrop","trueSize","onChange","handleCropSelect","onSelect","onRelease","handleCropRelease","Math","round","w","h","setSelect","ratio","Object","keys","reduce","a","k","encodeURIComponent","join","initLogin","loginForm","offsetHeight","setBodyScrollable","scrollable","initializeExistingMessages","initialize","findAll","createEditors","setPreferences","progressThemes","registerGlobalEvent"],"mappings":"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","file":"app.min.js","sourcesContent":["/**\n * Get closest DOM element up the tree matches the selector\n * @param  {Node} elem The base element\n * @param  {String} selector The selector to look for\n * @return {Node} Null if no match\n */\nvar parentMatchingSelector = function (elem, selector) {\n\n    // Get closest match\n    for ( ; elem && elem !== document; elem = elem.parentNode ) {\n\n        if(elem.matchesSelector(selector)) {\n            return elem;\n        }\n    }\n\n    return null;\n};\n\nvar parentOrSelfMatchingSelector = function (elem, selector) {\n    if(elem.matchesSelector(selector)) {\n        return elem;\n    }\n\n    // Get closest match\n    for ( ; elem && elem !== document; elem = elem.parentNode ) {\n\n        if(elem.matchesSelector(selector)) {\n            return elem;\n        }\n    }\n\n    return null;\n};\n\nNodeList.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator];\nHTMLCollection.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator];\n\nvar matchesMethod = (function() {\n    var ElemProto = Element.prototype;\n    // check for the standard method name first\n    if ( ElemProto.matches ) {\n        return 'matches';\n    }\n    // check un-prefixed\n    if ( ElemProto.matchesSelector ) {\n        return 'matchesSelector';\n    }\n    // check vendor prefixes\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\n\n    for ( var i=0; i < prefixes.length; i++ ) {\n        var prefix = prefixes[i];\n        var method = prefix + 'MatchesSelector';\n        if ( ElemProto[ method ] ) {\n            return method;\n        }\n    }\n})();\n\nElement.prototype.matchesSelector = function(selector) {\n    return this[matchesMethod](selector);\n};\n","// ================================\n//            AjaxRequest\n// ================================\n\nclass Dialog {\n\n    static registerEvents(container) {\n        for(let item of container.querySelectorAll(\"[data-dialog-type=\\\"confirm\\\"]\")) {\n            item.addEventListener(\"click\", Dialog.handleConfirmClick);\n        }\n        for(let item of container.querySelectorAll(\"[data-dialog-type=\\\"alert\\\"]\")) {\n            item.addEventListener(\"click\", Dialog.handleAlertClick);\n        }\n    }\n\n    static handleAlertClick(event) {\n        vex.dialog.alert(event.currentTarget.getAttribute(\"data-dialog-message\"));\n    }\n\n    static handleConfirmClick(event, customConfig) {\n        var target = event.currentTarget;\n        if (!(target.getAttribute(\"data-dialog-disabled\") === \"true\")) {\n            var defaultConfig;\n            event.preventDefault();\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n\n            defaultConfig = {\n                message: target.getAttribute(\"data-dialog-message\"),\n                callback(value) {\n                    if(value) {\n                        target.setAttribute(\"data-dialog-disabled\", \"true\");\n                        target.click();\n                    }\n                }\n            };\n\n            for (var attribute in customConfig) {\n                defaultConfig[attribute] = customConfig[attribute];\n            }\n\n            return vex.dialog.confirm(defaultConfig);\n        }\n    }\n};\n\n\n","// ================================\n//             Dropdown\n// ================================\n\nclass Dropdown {\n\n    static registerGlobalEvent() {\n        return document.addEventListener(\"click\", Dropdown.handleGlobalClick);\n    }\n\n    static registerEvents(container) {\n        for(let item of container.querySelectorAll(\".\" + Dropdown.classes.dropdownToggle)) {\n            item.addEventListener(\"click\", Dropdown.handleClick);\n        }\n    }\n\n    static handleClick(event) {\n        var c = event.target;\n        while (!c.classList.contains(Dropdown.classes.dropdownToggle)) {\n            if (c.matchesSelector(\"a[href], form\")) { return; }\n            c = c.parentNode;\n        }\n        var dropdown = c.querySelector(\".\" + Dropdown.classes.dropdownList);\n        if (dropdown.classList.contains(Dropdown.classes.isActive)) {\n            dropdown.classList.remove(Dropdown.classes.isActive);\n        } else {\n            Dropdown.reset();\n            dropdown.classList.add(Dropdown.classes.isActive);\n        }\n    }\n\n    static handleGlobalClick(event) {\n        if(parentMatchingSelector(event.target, \".\" + Dropdown.classes.dropdownToggle) == null) {\n            Dropdown.reset();\n        }\n    }\n\n    static reset(event) {\n        for(let item of document.querySelectorAll(\".\" + Dropdown.classes.dropdownList)) {\n            item.classList.remove(Dropdown.classes.isActive);\n        }\n    }\n\n};\n\nDropdown.classes = {\n    dropdownToggle: \"Dropdown-container\",\n    dropdownList: \"Dropdown\",\n    isActive: \"is-active\"\n};","// ================================\n//              Form\n// ================================\n\nclass EditableList {\n\n    static registerEvents(container) {\n        for(let item of container.getElementsByClassName(EditableList.classes.add)) {\n            item.addEventListener(\"click\", EditableList.handleAdd);\n        }\n        container.addEventListener(\"click\", EditableList.handleRemove);\n    }\n\n    static handleAdd(event) {\n        var container = event.currentTarget.parentNode.querySelector(\".\" + EditableList.classes.container);\n        var template = container.querySelector(\".\" + EditableList.classes.template);\n        var template2 = template.cloneNode(true);\n        template2.classList.remove(EditableList.classes.template);\n        container.appendChild(template2);\n    }\n\n    static handleRemove(event) {\n        let item = parentOrSelfMatchingSelector(event.target, \".\" + EditableList.classes.remove);\n        if(item) {\n            var row = parentMatchingSelector(event.target, \".\" + EditableList.classes.row);\n            if(row.parentNode) {\n                row.parentNode.removeChild(row);\n                console.log('removed node');\n            }\n        }\n    }\n}\n\nEditableList.classes = {\n    container: \"EditableList\",\n    template: \"EditableList-template\",\n    row: \"EditableList-row\",\n    remove: \"EditableList-remove\",\n    add: \"EditableList-add\"\n};\n","// ================================\n//            AjaxRequest\n// ================================\n\nwindow.Oxygen || (window.Oxygen = {});\n\nclass FetchOptions {\n    constructor() {\n        this.headers = new Headers();\n    }\n    wantJson() {\n        this.headers.set(\"Accept\", \"application/json\");\n        return this;\n    }\n    contentType(type) {\n        this.headers.set(\"Content-Type\", type);\n        return this;\n    }\n    method(method) {\n        this.method = method;\n        return this;\n    }\n    body(body) {\n        this.body = body;\n        return this;\n    }\n    cookies() {\n        this.credentials = \"same-origin\";\n        return this;\n    }\n\n    static default() {\n        return (new FetchOptions()).cookies()\n    }\n}\n\nOxygen.respond = {};\n\nOxygen.respond.text = function(response) {\n    return response.text();\n}\nOxygen.respond.json = function(response) {\n    return response.json();\n}\n\nOxygen.respond.checkStatus = function(response) {\n    if(response.ok) {\n        return response;\n    } else {\n        let error = new Error();\n        error.response = response;\n        throw error;\n            /*.catch(error => {\n                response.text().then(text => {\n                    Oxygen.error.jsonParseError(error, text);\n                });\n                throw error;\n            })*/\n    }\n};\n\nOxygen.respond.notification = function(data) {\n    if(Notification.isNotification(data)) {\n        NotificationCenter.present(new Notification(data));\n    }\n    return data;\n};\n\nOxygen.respond.redirect = function(data) {\n    if(data.redirect) {\n        if (window.smoothState && !(data.hardRedirect === true)) {\n            window.smoothState.load(data.redirect, false);\n        } else {\n            window.location.replace(data.redirect);\n        }\n    }\n    return data;\n};\n\n// handle network errors\n// if(error.response.readyState === 0) {\n//     console.error(response);\n// }\n// Oxygen.error.jsonParseError = function(error, text) {\n//     console.error(\"Error while parsing JSON: \", error);\n//     console.log(\"Raw response: \", text);\n//\n//     new Notification({\n//         content: \"Could not parse JSON response. This is a bug.\",\n//         status: \"failed\"\n//     });\n// };\n\nOxygen.respond.handleAPIError = function(error) {\n    if(error.response && error.response instanceof Response) {\n        error.response\n            .json()\n            .then(Oxygen.handleAPIError)\n            .catch(err => {\n                console.error(\"Error response did not contain valid JSON: \", err);\n                NotificationCenter.present(new Notification({\n                    content: \"Whoops, looks like something went wrong.\",\n                    status: \"bug\"\n                }));\n            });\n    } else {\n        throw error;\n    }\n};\n\nOxygen.handleAPIError = function(content) {\n    console.error(content);\n    if(Notification.isNotification(content)) {\n        NotificationCenter.present(new Notification(content));\n    } else if(content.error) {\n        NotificationCenter.present(new Notification({\n            content:\n            \"PHP Exception of type <code class=\\\"no-wrap\\\">\" + content.error.type +\n            \"</code> with message <code class=\\\"no-wrap\\\">\" + content.error.message +\n            \"</code> thrown at <code class=\\\"no-wrap\\\">\" + content.error.file + \":\" + content.error.line +\n            \"</code>\",\n            status: \"bug\"\n        }));\n    } else {\n        console.log(\"JSON error response unhandled: \", content);\n\n        NotificationCenter.present(new Notification({\n            content: \"Whoops, looks like something went wrong.\",\n            status: \"bug\"\n        }));\n    }\n};\n","// ================================\n//              Form\n// ================================\n\n//\n// The Form helper can:\n// - display a message upon exit if there are any unsaved changes.\n// - send an async request with the form data on submit or change\n\nclass Form {\n\n    static findAll(container) {\n        for(let item of container.querySelectorAll(\"form\")) {\n            item.formObject = new Form(item);\n        }\n\n        $(container).find(Form.classes.taggableInput).tagging({\n            \"edit-on-delete\": false\n        });\n    }\n\n    static registerKeydownHandler() {\n        return document.addEventListener(\"keydown\", Form.handleKeydown);\n    }\n\n    static handleKeydown(event) {\n        // check for Command/Control S\n        if ((event.ctrlKey || event.metaKey) && event.which === 83) {\n\n            var forms = document.getElementsByTagName(\"form\");\n            for (let i = 0; i < forms.length; i++) {\n                let form = forms[i];\n                if(form.classList.contains(Form.classes.submitOnKeydown) && form.formObject) {\n                    form.formObject.submit();\n                    event.preventDefault();\n                }\n            }\n        }\n    }\n\n    constructor(element) {\n        this.form = element;\n        this.originalData = getFormData(this.form);\n        //# content generators are notified before the form content is read\n        this.contentGenerators = [];\n        this.registerEvents();\n    }\n\n    registerEvents() {\n        // Exit Dialog\n        if (this.form.classList.contains(Form.classes.warnBeforeExit)) {\n            for(let item of document.querySelectorAll(\"a, button[type=\\\"submit\\\"]\")) {\n                item.addEventListener(\"click\", event => this.handleExit(event)); // displays exit dialog\n            }\n        }\n\n        // Submit asynchronously\n        this.form.addEventListener(\"submit\", event => this.handleSubmit(event));\n        if (this.form.classList.contains(Form.classes.submitAsyncOnChange)) {\n            this.form.addEventListener(\"change\", event => {\n                event.preventDefault();\n                this.submitAsync();\n            });\n        }\n\n        // Auto Submit\n        if (this.form.classList.contains(Form.classes.autoSubmit)) {\n            return this.submit();\n        }\n    }\n\n    handleExit(event) {\n        if (event.currentTarget.classList.contains(\"Form-submit\")) { return; }\n        if (!document.body.contains(this.form)) { return; }\n        this.generateContent();\n        var original = this.originalData;\n        var current = getFormData(this.form);\n        console.log(\"original form data:\", original);\n        console.log(\"current form data:\", current);\n        if(!compareByValue(original, current)) {\n            console.log(\"=> form data differs\");\n            var target = event.currentTarget;\n\n            if (!(target.getAttribute(\"data-dialog-disabled\") === \"true\")) {\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation(),\n\n                vex.dialog.confirm({\n                    message:  Form.messages.confirmation,\n                    buttons: [\n                        {\n                            text: 'Save',\n                            type: 'button',\n                            className: 'vex-dialog-button-primary',\n                            click: function($vexContent, event) {\n                                $vexContent.data().vex.value = \"save\";\n                                vex.close($vexContent.data().vex.id);\n                            }\n                        },\n                        $.extend({}, vex.dialog.buttons.NO, {text: 'Cancel'}),\n                        {\n                            text: 'Don\\'t Save',\n                            type: 'button',\n                            className: 'vex-dialog-button-secondary vex-dialog-button-left',\n                            click: function($vexContent, event) {\n                                $vexContent.data().vex.value = \"continue\";\n                                vex.close($vexContent.data().vex.id);\n                            }\n                        }\n                    ],\n                    callback: (value) => {\n                        if(value == \"continue\") {\n                            target.setAttribute(\"data-dialog-disabled\", \"true\");\n                            return target.click();\n                        } else if(value == \"save\") {\n                            if (this.form.classList.contains(Form.classes.submitAsync)) {\n                                this.submitAsync(true);\n                                target.setAttribute(\"data-dialog-disabled\", \"true\");\n                                target.click();\n                            } else {\n                                // not sure if this works\n                                this.submit();\n                                //target.attr(\"data-dialog-disabled\", \"true\");\n                                //target.click();\n                            }\n                        }\n                    }\n                });\n            }\n        }\n    }\n\n    submit() {\n        this.form.querySelector('button[type=\"submit\"]').click();\n    }\n\n    generateContent() {\n        for (var generator of this.contentGenerators) {\n            generator(this);\n        }\n    }\n\n    handleSubmit(event) {\n        this.generateContent();\n        if (this.form.classList.contains(Form.classes.submitAsync) && !Form.disableAsync) {\n            event.preventDefault();\n            this.submitAsync();\n        }\n    }\n\n    submitAsync(ignoreRedirectResponse) {\n        var saveData = (data) => {\n            if (data.status === 'success') {\n                this.originalData = getFormData(this.form);\n                console.log('Form Saved Successfully');\n            }\n            return data;\n        };\n\n        let data = getFormData(this.form);\n        console.log(\"Submitting Form with Data: \", data);\n\n        var promise = window.fetch(\n            this.form.action,\n            FetchOptions.default()\n                .method(this.form.method)\n                .body(getFormDataObject(data))\n                .wantJson()\n        )\n            .then(Oxygen.respond.checkStatus)\n            .then(Oxygen.respond.json)\n            .then(saveData);\n\n        let modifyPromise = this.form.modifyPromise;\n        if(modifyPromise === undefined) {\n            modifyPromise = function(promise) { return promise; };\n        }\n\n        promise = promise.then(Oxygen.respond.notification);\n\n        if(!ignoreRedirectResponse) {\n            promise = promise.then(Oxygen.respond.redirect);\n        }\n\n        promise = modifyPromise(promise);\n        promise = promise.catch(Oxygen.respond.handleAPIError);\n\n        return promise;\n    }\n}\n\nfunction getFormData(form) {\n    var data = {};\n\n    for(let item of form.querySelectorAll(\"[name]\")) {\n        if(item.type == \"checkbox\" || item.type == \"radio\") {\n            if(!item.checked) {\n                continue;\n            }\n        }\n\n        if(item.name == undefined) {\n            console.dir(item);\n        }\n        if (item.type == \"select-multiple\") {\n            data[item.name] = [];\n            for(let option of item.options) {\n                if(option.selected) {\n                    data[item.name].push(option.value);\n                }\n            }\n        } else if(item.type == \"file\") {\n            var ref;\n            var files = ((ref = item.filesToUpload) != null) ? ref : item.files;\n            data[item.name] = [];\n            for (var i = 0, file; i < files.length; i++) {\n                file = files[i];\n                data[item.name].push(file);\n            }\n        } else if(item.name.endsWith(\"[]\")) {\n            if(typeof data[item.name] == 'undefined' || data[item.name] === null) {\n                data[item.name] = [];\n            }\n            data[item.name].push(item.value);\n        } else {\n            data[item.name] = item.value;\n        }\n    }\n\n    return data;\n}\n\nfunction getFormDataObject(data) {\n    var formData = new FormData();\n\n    for(let key in data) {\n        if(data[key] instanceof Array) {\n            for(let value of data[key]) {\n                formData.append(key, value);\n            }\n        } else {\n            formData.append(key, data[key]);\n        }\n    }\n\n    return formData;\n}\n\n/// The `===` operator or `Object.is` doesn't cut it.\n/// https://gist.github.com/nicbell/6081098\nfunction compareByValue(obj1, obj2) {\n\t//Loop through properties in object 1\n\tfor (var p in obj1) {\n\t\t//Check property exists on both objects\n\t\tif (obj1.hasOwnProperty(p) !== obj2.hasOwnProperty(p)) {\n            return false;\n        }\n\n\t\tswitch (typeof (obj1[p])) {\n\t\t\t//Deep compare objects\n\t\t\tcase 'object':\n\t\t\t\tif (!compareByValue(obj1[p], obj2[p])) { return false; }\n\t\t\t\tbreak;\n\t\t\t//Compare function code\n\t\t\tcase 'function':\n\t\t\t\tif (typeof (obj2[p]) == 'undefined' || (p != 'compare' && obj1[p].toString() != obj2[p].toString())) {\n                    return false;\n                }\n\t\t\t\tbreak;\n\t\t\t//Compare values\n\t\t\tdefault:\n\t\t\t\tif (obj1[p] != obj2[p]) { return false; }\n\t\t}\n\t}\n\n\t//Check object 2 for any extra properties\n\tfor (var p in obj2) {\n        if(obj2.hasOwnProperty(p)) {\n            if (typeof (obj1[p]) == 'undefined') {\n                return false;\n            }\n        }\n\t}\n\treturn true;\n};\n\nForm.disableAsync = false;\n\n/**\n * Toggles whether asynchronous form submission is enabled globally, using Alt + Command/Control + J\n */\ndocument.addEventListener(\"keydown\", function(event) {\n    if(event.altKey && (event.controlKey || event.metaKey) && event.which == 74) {\n        Form.disableAsync = !Form.disableAsync;\n        event.preventDefault();\n        NotificationCenter.present(new Notification({\n            content: \"Asynchronous form submission \" + (Form.disableAsync ? \"disabled\" : \"enabled\"),\n            status: \"info\"\n        }));\n    }\n});\n\nForm.messages = {\n    confirmation: \"Do you want to save changes?\"\n};\n\nForm.classes = {\n    warnBeforeExit: \"Form--warnBeforeExit\",\n    submitOnKeydown: \"Form--submitOnKeydown\",\n    submitAsync: \"Form--sendAjax\",\n    submitAsyncOnChange: \"Form--sendAjaxOnChange\",\n    autoSubmit: \"Form--autoSubmit\",\n    taggableInput: \".Form-taggable\"\n};\n","// ================================\n//             MainNav\n// ================================\n\nclass MainNav {\n\n    static headroom() {\n        let header = document.querySelector(\".MainNav\");\n\n        if (header && window.innerWidth > 768) {\n            let headroom = new Headroom(header, {\n                \"tolerance\": 20,\n                \"offset\": 50,\n                \"classes\":\n                    {\"initial\": \"Headroom\",\n                    \"pinned\": \"Headroom--pinned\",\n                    \"unpinned\": \"Headroom--unpinned\",\n                    \"top\": \"Headroom--top\",\n                    \"notTop\": \"Headroom--not-top\"\n                    }\n            });\n            headroom.init();\n        }\n    }\n}","// ================================\n//             Notification\n// ================================\n\nclass NotificationCenter {\n    static initializeExistingMessages() {\n        let notifications = document\n            .querySelector(\".\" + Notification.classes.container)\n            .querySelectorAll(\".\" + Notification.classes.item)\n        for(let item of notifications) {\n            NotificationCenter.registerHide(new Notification({\n                message: item\n            }));\n        }\n    }\n\n    static present(notification) {\n        document\n            .querySelector(\".\" + Notification.classes.container)\n            .appendChild(notification.message);\n\n        NotificationCenter.registerHide(notification)\n    }\n\n    static registerHide(notification) {\n        if(notification.hideAfter != null) {\n            let auto = setTimeout(\n                function() { NotificationCenter.hide(notification); },\n                notification.hideAfter\n            );\n        }\n\n        notification.message.addEventListener(\n            \"click\",\n            event => {\n                NotificationCenter.hide(notification);\n                if(typeof auto !== 'undefined') {\n                    clearTimeout(auto);\n                }\n            }\n        );\n    }\n\n    static hide(notification) {\n        notification.message.classList.add(\"is-sliding-up\");\n        setTimeout(\n            function() {\n                let node = notification.message;\n                if(node.parentNode) {\n                    node.parentNode.removeChild(node);\n                }\n            },\n            500\n        );\n    }\n}\n\nclass Notification {\n    constructor(options) {\n        if (options.log) { console.log(options.log); }\n\n        this.hideAfter = 15 * 1000;\n\n        if (options.message) {\n            // Constructs a Notification object\n            // using a pre-existing message element.\n            this.message = options.message;\n            this.message.classList.remove(\"is-hidden\");\n        } else if (options.status && options.content) {\n            // Constructs a Notification object,\n            // creating a new message element.\n            this.message = document.createElement(\"div\");\n            this.message.classList.add(Notification.classes.item);\n            this.message.classList.add(\"Notification--\" + options.status);\n            if(options.status == \"failed\") {\n                this.hideAfter = null;\n            }\n            this.message.innerHTML = options.content +\n                \"<span class=\\\"Notification-dismiss Icon Icon-times\\\"></span>\";\n        } else {\n            throw new Error(\"Invalid Arguments For New Notification: \" + JSON.stringify(options));\n        }\n    }\n\n    static isNotification(obj) {\n        return obj.message !== undefined || (obj.content !== undefined && obj.status !== undefined);\n    }\n}\n\nNotification.classes = {\n    container: \"Notification-container\",\n    item: \"Notification\"\n};\n","// ================================\n//             Notification\n// ================================\n\nclass Preferences {\n\n    static setPreferences(preferences) {\n        return Preferences.preferences = preferences;\n    }\n\n    static isDefined(o) {\n        return typeof o !== \"undefined\" && o !== null;\n    }\n\n    static get(key, fallback = null) {\n        var o = Preferences.preferences;\n\n        if(!Preferences.isDefined(o)) {\n            return fallback;\n        }\n\n        var parts = key.split('.');\n        //var last = parts.pop();\n        var l = parts.length;\n        var i = 0;\n\n        while(Preferences.isDefined(o) && i < l) {\n            var idx = parts[i];\n            o = o[idx];\n            i++;\n        }\n\n        if (Preferences.isDefined(o)) {\n            return o;\n        } else {\n            console.log(\"Preferences key \", key, \"was not defined, using default \", fallback);\n            return fallback;\n        }\n    }\n\n    static has(key) {\n        var o = Preferences.preferences;\n\n        if(!o) {\n            return false;\n        }\n\n        var parts = key.split('.');\n        var last = parts.pop();\n        var l = parts.length;\n        var i = 1;\n        var current = parts[0];\n\n        while((o = o[current]) && i < l) {\n            current = parts[i];\n            i++;\n        }\n\n        return o;\n    }\n}\n\n\n","// ================================\n//            Slider\n// ================================\n\nclass Slider {\n\n    static findAll(container) {\n        for(let item of container.querySelectorAll(Slider.selectors.slider)) {\n            Slider.list.push(new Slider(item));\n        }\n    }\n\n    // -----------------\n    //       Object\n    // -----------------\n\n    constructor(container) {\n        this.container = container;\n        this.list = this.container.querySelector(Slider.selectors.list);\n        this.items = this.container.querySelectorAll(Slider.selectors.item);\n        this.interval = this.container.getAttribute(\"data-interval\") || 5000;\n\n        this.previousId = 0;\n        this.currentId = 0;\n        this.nextId = 0;\n        this.animating = false;\n        this.animationTime = 1000;\n\n        this.registerEvents();\n        this.next();\n\n        if (this.container.getAttribute(\"data-autoplay\") === \"true\") {\n            this.play();\n        }\n    }\n\n    registerEvents() {\n        this.container.querySelector(Slider.selectors.back).addEventListener(\"click\", this.previous.bind(this));\n        this.container.querySelector(Slider.selectors.forward).addEventListener(\"click\", this.next.bind(this));\n    }\n\n    play() {\n        var callback = this.container.getAttribute(\"data-direction\") === \"reverse\" ? this.previous.bind(this) : this.next.bind(this);\n        this.timer = setInterval(callback, this.interval);\n    }\n\n    pause() {\n        clearInterval(this.timer);\n    }\n\n    hideAll() {\n        for(var item of this.items) {\n            item.classList = \"\";\n            item.classList.add(Slider.classes.item);\n            item.classList.add(Slider.classes.isHidden);\n        }\n    }\n\n    getItem(id) {\n        let item = this.items[id];\n        if(item === undefined || item === null) {\n            console.error(\"no slider item at index: \", id);\n        }\n        return item;\n    }\n\n    next() {\n        if (!this.shouldAnimate()) {\n            return false;\n        }\n\n        this.previousId = this.currentId;\n\n        this.currentId += 1;\n        if (this.currentId >= this.items.length) {\n            this.currentId = 0;\n        }\n\n        this.nextId = this.currentId + 1;\n        if (this.nextId >= this.items.length) {\n            this.nextId = 0;\n        }\n\n        var current = this.getItem(this.currentId);\n        var previous = this.getItem(this.previousId);\n\n        this.hideAll();\n\n        previous.classList.remove(Slider.classes.isHidden);\n        previous.classList.add(Slider.classes.slideOutLeft);\n        current.classList.remove(Slider.classes.isHidden);\n        current.classList.add(Slider.classes.slideInRight);\n    }\n\n    previous() {\n        if (!this.shouldAnimate()) {\n            return false;\n        }\n\n        this.nextId = this.currentId;\n\n        this.currentId -= 1;\n        if (this.currentId <= 0) {\n            this.currentId = this.items.length - 1;\n        }\n\n        this.previousId = this.currentId - 1\n        if (this.nextId <= 0) {\n            this.nextId = this.items.length - 1;\n        }\n\n        var current = this.getItem(this.currentId);\n        var next = this.getItem(this.nextId);\n\n        this.hideAll();\n\n        next.classList.remove(Slider.classes.isHidden);\n        next.classList.add(Slider.classes.slideOutRight);\n        current.classList.remove(Slider.classes.isHidden);\n        current.classList.add(Slider.classes.slideInLeft);\n    }\n\n    shouldAnimate() {\n        if (this.animating) {\n            return false;\n        }\n\n        this.animating = true;\n        setTimeout(\n            () => {\n                this.animating = false;\n            },\n            this.animationTime\n        );\n\n        return true;\n    }\n};\n\nSlider.selectors = {\n    slider: \".Slider\",\n    list: \".Slider-list\",\n    item: \".Slider-item\",\n    back: \".Slider-back\",\n    forward: \".Slider-forward\"\n};\n\nSlider.classes = {\n    item: \"Slider-item\",\n    isCurrent: \"Slider-item--current\",\n    isHidden: \"Slider-item--hidden\",\n    slideInLeft: \"Slider-item--slideInLeft\",\n    slideInRight: \"Slider-item--slideInRight\",\n    slideOutLeft: \"Slider-item--slideOutLeft\",\n    slideOutRight: \"Slider-item--slideOutRight\",\n    isAfter: \"Slider-item--after\",\n    noTransition: \"Slider--noTransition\"\n};\n\nSlider.list = [];","class SmoothState {\n    constructor() {\n        this.loading = false;\n        this.smoothState = $(\"#page\").smoothState({\n            anchors: \".Link--smoothState\",\n            root: $(document),\n            cacheLength: 0,\n            forms: \"null\",\n            onStart: {\n                duration: 350,\n                render: this.onStart\n            },\n            onProgress: {\n                duration: 0,\n                render: this.onProgress\n            },\n            onReady: {\n                duration: 0,\n                render: this.onReady\n            },\n            onAfter: this.onAfter\n        }).data('smoothState');\n    }\n\n    onStart(container) {\n        for(let item of document.querySelectorAll(\"html, body\")) { item.scrollTop = 0; }\n        this.loading = true;\n\n        var elements = document.getElementsByClassName('Block');\n        var blocks = Array.prototype.slice.call(elements);\n        blocks.reverse();\n        for(let i = 0; i < blocks.length; i++) {\n            let block = blocks[i];\n            setTimeout(function() {\n                return block.classList.add('Block--isExiting');\n            }, i * 50);\n        }\n\n        /*setTimeout(function() {\n            if(this.loading) {\n                return document.querySelector(\".pace-activity\").classList.add(\"pace-activity-active\");\n            }\n        }, blocks.length * 100);*/\n    }\n\n    onProgress(container) {\n        SmoothState.setCursor('wait');\n    };\n\n    static setCursor(mode) {\n        let items = document.querySelectorAll(\"html, body\");\n        for(let item of items) {\n            item.style.cursor = mode;\n        }\n        let links = document.querySelectorAll(\"a\");\n        for(let item of links) {\n            item.style.cursor = mode;\n        }\n    }\n\n    onReady(container, content) {\n        SmoothState.setCursor('auto');\n\n        Oxygen.reset();\n        container[0].style.display = 'none';\n        container.html(content);\n        document.querySelector(\".pace-activity\").classList.remove(\"pace-activity-active\");\n        let blocks = document.getElementsByClassName('Block');\n        for(var i = 0; i < blocks.length; i++) {\n            let block = blocks[i];\n            block.classList.add('Block--isHidden');\n            setTimeout(function() {\n                block.classList.remove('Block--isHidden');\n                block.classList.add('Block--isEntering');\n                setTimeout(function() {\n                    block.classList.remove('Block--isEntering');\n                }, 250);\n            }, i * 50);\n        }\n        container[0].style.display = 'block';\n    };\n\n    onAfter(container, content) {\n        this.loading = false;\n        //document.querySelector(\".pace-activity\").classList.remove(\"pace-activity-active\");\n        return Oxygen.init(document.getElementById(\"page\"));\n    };\n\n    static setTheme(theme) {\n        console.log(\"Setting SmoothState Theme: \", theme);\n        let page = document.getElementById(\"page\");\n        if(page) {\n            page.classList.add('Page-transition--' + theme);\n        }\n    };\n\n    load(url, push) {\n        return this.smoothState.load(url, push);\n    };\n\n}\n","// ================================\n//          ProgressBar\n// ================================\n\nclass TabSwitcher {\n\n    static findAll(container) {\n        for(let item of container.querySelectorAll(TabSwitcher.selectors.container)) {\n            console.log(item);\n            /*var tabs = $(item);\n            if (tabs.classList.contains(TabSwitcher.classes.content)) {\n                container = tabs;\n            } else {\n                container = tabs.parentNode.querySelector(\".\" + TabSwitcher.classes.content);\n            }\n\n            if (container.length === 0) { container = tabs.parentNode.parentNode.querySelector(\".\" + TabSwitcher.classes.content); }*/\n\n            let tabs = item.matchesSelector(TabSwitcher.selectors.tabs) ? item : item.querySelector(TabSwitcher.selectors.tabs);\n            let content = item.matchesSelector(TabSwitcher.selectors.content) ? item : item.querySelector(TabSwitcher.selectors.content);\n\n            TabSwitcher.list.push(new TabSwitcher(tabs, content));\n        }\n    }\n\n    // -----------------\n    //       Object\n    // -----------------\n\n    constructor(tabs, content) {\n        this.tabs = tabs;\n        this.content = content;\n        this.findDefault();\n        this.registerEvents();\n    }\n\n    findDefault() {\n        var tab = this.tabs.querySelector(\"[data-default-tab]\").getAttribute(\"data-switch-to-tab\");\n        this.setTo(tab);\n    }\n\n    registerEvents() {\n        this.tabs.querySelectorAll(\"[data-switch-to-tab]\").forEach(item => {\n            item.addEventListener(\"click\", event => {\n                this.setTo(event.currentTarget.getAttribute(\"data-switch-to-tab\"));\n            });\n        });\n    }\n\n    setTo(tab) {\n        this.current = tab;\n\n        for(let item of this.content.querySelectorAll(\"[data-tab]\")) {\n            item.classList.remove(TabSwitcher.classes.active);\n        }\n        this.content.querySelector(\"[data-tab=\\\"\" + tab + \"\\\"]\").classList.add(TabSwitcher.classes.active);\n\n        for(let item of this.tabs.querySelectorAll(\"[data-switch-to-tab]\")) {\n            item.classList.remove(TabSwitcher.classes.active);\n        }\n        this.tabs.querySelector(\"[data-switch-to-tab=\\\"\" + tab + \"\\\"]\").classList.add(TabSwitcher.classes.active);\n    }\n}\n\n// -----------------\n//       Static\n// -----------------\n\nTabSwitcher.classes = {\n    active: \"TabSwitcher--isActive\"\n};\n\nTabSwitcher.selectors = {\n    container: \".TabSwitcher\",\n    tabs: \".TabSwitcher-tabs\",\n    content: \".TabSwitcher-content\"\n}\n\nTabSwitcher.list = [];\n","// ================================\n//             Toggle\n// ================================\n\nclass Toggle {\n\n    constructor(toggle, enableCallback, disableCallback) {\n        this.toggle = toggle;\n        this.enableCallback = enableCallback;\n        this.disableCallback = disableCallback;\n\n        this.registerEvents();\n    }\n\n    registerEvents() {\n        this.toggle.addEventListener(\"click\", event => this.handleToggle(event));\n        if(this.toggle.getAttribute(\"data-enabled\") == undefined) {\n            this.toggle.setAttribute(\"data-enabled\", \"false\");\n        }\n    }\n\n    handleToggle(event) {\n        if (this.toggle.getAttribute(\"data-enabled\") === \"true\") {\n            this.toggle.setAttribute(\"data-enabled\", \"false\");\n            this.disableCallback(event);\n        } else {\n            this.toggle.setAttribute(\"data-enabled\", \"true\");\n            this.enableCallback(event);\n        }\n    }\n}\n\nToggle.classes = {\n    ifEnabled:  \"Toggle--ifEnabled\",\n    ifDisabled: \"Toggle--ifDisabled\"\n};\n\n// ================================\n//        FullscreenToggle\n// ================================\n\nclass FullscreenToggle extends Toggle {\n\n    constructor(toggle, fullscreenElement, enterFullscreenCallback = function() {}, exitFullscreenCallback = function() {}) {\n        super(toggle, null, null);\n        this.fullscreenElement = fullscreenElement;\n        this.enableCallback = this.enterFullscreen;\n        this.disableCallback = this.exitFullscreen;\n        this.enterFullscreenCallback = enterFullscreenCallback;\n        this.exitFullscreenCallback = exitFullscreenCallback;\n    }\n\n    enterFullscreen() {\n        this.fullscreenElement.classList.add(\"FullscreenToggle--isFullscreen\");\n        document.body.classList.add(\"Body--noScroll\");\n\n        var elem = document.documentElement;\n        if (elem.requestFullscreen) {\n            elem.requestFullscreen();\n        } else if (elem.msRequestFullscreen) {\n            elem.msRequestFullscreen();\n        } else if (elem.mozRequestFullScreen) {\n            elem.mozRequestFullScreen();\n        } else if (elem.webkitRequestFullscreen) {\n            elem.webkitRequestFullscreen();\n        }\n\n        (this.enterFullscreenCallback)();\n    }\n\n    exitFullscreen() {\n        this.fullscreenElement.classList.remove(\"FullscreenToggle--isFullscreen\");\n        document.body.classList.remove(\"Body--noScroll\");\n\n        if (document.exitFullscreen) {\n            document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n            document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n            document.webkitExitFullscreen();\n        }\n\n        (this.exitFullscreenCallback)();\n    }\n}\n\n","class Upload {\n\n    static registerEvents(container) {\n        for(let item of container.querySelectorAll(Upload.selectors.uploadElement)) {\n            var dropzone = item.querySelector(Upload.selectors.dropzoneElement);\n            dropzone.addEventListener(\"dragover\", Upload.handleDragOver);\n            dropzone.addEventListener(\"dragleave\", Upload.handleDragLeave);\n            dropzone.addEventListener(\"drop\", Upload.handleDrop);\n            item.querySelector(\"input[type=file]\").addEventListener(\"change\", Upload.handleChange);\n        }\n    };\n\n    static handleDragOver(event) {\n        event.preventDefault();\n        return event.currentTarget.classList.add(Upload.states.onDragOver);\n    };\n\n    static handleDragLeave(event) {\n        return event.currentTarget.classList.remove(Upload.states.onDragOver);\n    };\n\n    static handleDrop(event) {\n        event.preventDefault();\n        event.currentTarget.classList.remove(Upload.states.onDragOver);\n        var upload = parentMatchingSelector(event.currentTarget, Upload.selectors.uploadElement);\n        Upload.addFiles(upload, event.dataTransfer.files);\n    };\n\n    static handleChange(event) {\n        Upload.addFiles(parentMatchingSelector(event.currentTarget, Upload.selectors.uploadElement), event.currentTarget.files);\n        console.dir(event.currentTarget);\n        event.currentTarget.value = \"\"; // reset the input field, so that the change event is always called.\n    };\n\n    static addFiles(upload, files) {\n        let input = upload.querySelector('input[type=\"file\"]');\n        for(let file of files) {\n            let imageType = /^image\\//;\n            console.log(file.type);\n            let preview = document.createElement(\"div\");\n            preview.classList.add(\"FileUpload-preview\");\n            preview.innerHTML = '<div class=\"FileUpload-preview-info\">' +\n                    '<span>' + file.name + '</span>' +\n                    '<button type=\"button\" class=\"FileUpload-preview-remove Button--transparent Icon Icon-times\"></button>' +\n                    '<span class=\"FileUpload-preview-size\">' + fileSize(file.size) + '</span>' +\n                '</div>';\n            upload.insertBefore(preview, upload.firstChild);\n            preview.querySelector(Upload.selectors.removeFile).addEventListener(\"click\", function(event) {\n                var button, index;\n                button = event.currentTarget;\n                preview = parentMatchingSelector(button, Upload.selectors.previewElement);\n                index = input.filesToUpload.indexOf(file);\n\n                if(index > -1) {\n                    input.filesToUpload.splice(index, 1)\n                }\n                Upload.recalculateDropzoneVisibility(upload, files);\n                preview.parentNode.removeChild(preview);\n            });\n            if (input.filesToUpload == null) {\n                input.filesToUpload = [];\n            }\n            input.filesToUpload.push(file);\n            if (imageType.test(file.type)) {\n                let reader = new FileReader();\n                reader.onload = function (e) {\n                    preview.style.backgroundImage = 'url(' + e.target.result + ')';\n                };\n                reader.readAsDataURL(file);\n            } else {\n                let container = document.createElement(\"div\");\n                container.classList.add(\"Icon-container\");\n                let icon = document.createElement(\"span\");\n                icon.classList.add(\"Icon\", \"Icon--gigantic\", \"Icon--light\", \"Icon-file-text\");\n                container.appendChild(icon);\n                preview.insertBefore(container, preview.firstChild);\n            }\n        }\n        Upload.recalculateDropzoneVisibility(upload);\n        console.log(files);\n    };\n\n    static recalculateDropzoneVisibility(upload, files) {\n        var input = upload.querySelector('input[type=\"file\"]');\n        var dropzone = upload.querySelector(Upload.selectors.dropzoneElement);\n        if(!input.multiple && input.filesToUpload.length > 0) {\n            dropzone.style.display = \"none\";\n        } else {\n            dropzone.style.display = \"block\";\n        }\n    }\n\n};\n\nUpload.selectors = {\n    uploadElement: \".FileUpload\",\n    previewElement: \".FileUpload-preview\",\n    dropzoneElement: \".FileUpload-dropzone\",\n    removeFile: \".FileUpload-preview-remove\"\n};\n\nUpload.states = {\n    onDragOver: \"FileUpload--onDragOver\"\n};\n\nfunction fileSize(sizeInBytes) {\n    var approx, multiple, multiples, output;\n    output = sizeInBytes + \" bytes\";\n    multiples = ['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    multiple = 0;\n    approx = sizeInBytes / 1024;\n    while (approx > 1) {\n        output = approx.toFixed(3) + ' ' + multiples[multiple];\n        approx /= 1024;\n        multiple++;\n    }\n    return output;\n}\n","// ================================\n//          CodeViewInterface\n// ================================\n\nclass CodeViewInterface {\n\n    constructor(editor) {\n        this.editor = editor;\n        this.ace = null;\n    }\n\n    create() {\n        // edit the textarea\n        var object = ace.edit(this.editor.name + \"-ace-editor\");\n\n        // set user preferences\n        object.getSession().setMode(\"ace/mode/\" + this.editor.language);\n        object.setTheme(Preferences.get('editor.ace.theme'));\n        object.getSession().setUseWrapMode(Preferences.get('editor.ace.wordWrap'));\n        object.setHighlightActiveLine(Preferences.get('editor.ace.highlightActiveLine'));\n        object.setShowPrintMargin(Preferences.get('editor.ace.showPrintMargin'));\n        object.setShowInvisibles(Preferences.get('editor.ace.showInvisibles'));\n        object.setReadOnly(this.editor.readOnly);\n\n        // store object\n        this.ace = object;\n        this.view = document.getElementById(this.editor.name + \"-ace-editor\");\n        this.view.style.fontSize = Preferences.get('editor.ace.fontSize');\n    }\n\n    show(full) {\n        console.log(\"CodeViewInterface.show\");\n        this.view.classList.remove(Editor.classes.state.isHidden);\n        if (full) {\n            this.view.style.width = \"100%\";\n        }\n\n        // after animation is completed\n        setTimeout(() => {\n            this.resize();\n        }, 300);\n    }\n\n    hide() {\n        console.log(\"CodeViewInterface.hide\");\n        this.view.classList.add(Editor.classes.state.isHidden);\n    }\n\n    valueFromForm() {\n        this.ace.setValue(this.editor.textarea.value, -1);\n    }\n\n    valueToForm() {\n        this.editor.textarea.value = this.ace.getValue();\n    }\n\n    resize() {\n        this.ace.resize();\n    }\n}\n","// ================================\n//          DesignViewInterface\n//   ================================\n\nclass DesignViewInterface {\n\n    constructor(editor) {\n        this.editor = editor;\n        this.ck = null;\n    }\n\n    create() {\n        var config = Preferences.get('editor.ckeditor', {});\n        config.customConfig = config.customConfig || '';\n        config.allowedContent = true;\n        config.entities = false;\n        config.protectedSource = [\n            // inline PHP\n            /<\\?[\\s\\S]*?\\?>/g,\n            // blade directives\n            /(\\n[ \\t]*)?@\\w+(\\((?:[^)(]+|\\((?:[^)(]+|\\([^)(]*\\))*\\))*\\))?\\n?/g,\n            // blade echo\n            /{{[\\s\\S]*?}}}?/g\n        ];\n        config.contentsCss = this.editor.stylesheets;\n\n        // create instance\n        CKEDITOR.dtd.$removeEmpty[\"span\"] = false;\n        this.ck = CKEDITOR.replace(this.editor.name + \"-editor\", config);\n        this.ck.on(\"instanceReady\", event => {\n            this.view = document.getElementById(\"cke_\" + this.editor.name + \"-editor\");\n            //put your code here\n        });\n    }\n\n    show(full) {\n        console.log(\"DesignViewInterface.show\");\n        if(this.view) {\n            this.view.style.display = \"block\";\n            if (full) {\n                this.view.style.width = \"100%\";\n            }\n        } else {\n            this.ck.on(\"instanceReady\", event => {\n                this.view.style.display = \"block\";\n                if (full) {\n                    this.view.style.width = \"100%\";\n                }\n            });\n        }\n    }\n\n    hide() {\n        this.view.style.display = \"none\";\n    }\n\n    valueFromForm() {\n        this.ck.setData(this.editor.textarea.value);\n    }\n\n    valueToForm() {\n        this.editor.textarea.value = this.ck.getData();\n    }\n}","// ================================\n//                 Editor\n// ================================\n\nclass Editor {\n\n    // only create if textarea exists\n    static createEditors(editors) {\n        for (var i = 0, editor; i < editors.length; i++) {\n            editor = editors[i];\n            var textarea = document.querySelector(\"textarea[name=\\\"\" + editor.name + \"\\\"]\");\n            if (textarea) {\n                console.log(\"Editor found\");\n                if (!(editor.mode != null)) { editor.mode = user.editor.defaultMode; }\n                console.log(editor);\n                var e = new Editor(editor.name, editor.language, editor.mode, editor.readOnly, editor.stylesheets);\n                Editor.list.push(e);\n            } else {\n                console.log(\"Editor not found\");\n                console.log(editor);\n            }\n        }\n    }\n\n    constructor(name, language, currentMode, readOnly, stylesheets = []) {\n        this.enterFullscreen = this.enterFullscreen.bind(this);\n        this.exitFullscreen = this.exitFullscreen.bind(this);\n        this.handleSwitchEditor = this.handleSwitchEditor.bind(this);\n        this.handleFormSubmit = this.handleFormSubmit.bind(this);\n        this.name = name;\n        this.language = language;\n        this.currentMode = currentMode;\n        this.readOnly = readOnly;\n        this.stylesheets = stylesheets;\n        this.modes = {};\n        this.textarea = document.querySelector(\"textarea[name=\\\"\" + this.name + \"\\\"]\");\n        this.container = parentMatchingSelector(this.textarea, \".\" + Editor.classes.editor.container);\n        var toggle = this.container.querySelector(\".\" + Editor.classes.button.fullscreenToggle);\n        if(toggle) {\n            this.fullscreenToggle = new FullscreenToggle(toggle, this.container, this.enterFullscreen, this.exitFullscreen);\n        }\n\n        this.show();\n        this.resizeToContent();\n        this.registerEvents();\n    }\n\n    getMode(mode) {\n        if (!(typeof mode !== \"undefined\" && mode !== null)) {\n            return this.currentMode;\n        } else {\n            return mode;\n        }\n    }\n\n    registerEvents() {\n        // switch editor button\n        for(let button of this.container.querySelectorAll(\".\" + Editor.classes.button.switchEditor)) {\n            button.addEventListener(\"click\", this.handleSwitchEditor);\n        }\n\n        // ask the form to tell us when its data is being read,\n        // so we can flush changes to the underlying <input>/<textarea> element\n        var form = parentMatchingSelector(this.container, \"form\");\n        if(form !== null && form.formObject) {\n            form.formObject.contentGenerators.push(form =>\n                this.valueToForm()\n            );\n        }\n    }\n\n    create(m) {\n        var mode = this.getMode(m);\n        switch (mode) {\n            case \"code\":\n                this.modes.code = new CodeViewInterface(this);\n                break;\n            case \"design\":\n                this.modes.design = new DesignViewInterface(this);\n                break;\n            case \"preview\":\n                this.modes.preview = new PreviewInterface(this);\n                break;\n            case \"split\":\n                this.modes.split = new SplitViewInterface(this);\n                break;\n        }\n        this.modes[mode].create();\n    }\n\n    show(m, full = true) {\n        var mode = this.getMode(m);\n        if (!(this.modes[mode] != null)) { this.create(mode); }\n        this.modes[mode].show(full);\n        this.currentMode = mode;\n        this.valueFromForm(mode);\n    }\n\n    hide(m) {\n        var mode = this.getMode(m);\n        this.modes[mode].hide();\n        this.valueToForm(mode);\n    }\n\n    valueFromForm(m) {\n        var mode = this.getMode(m);\n        this.modes[mode].valueFromForm();\n    }\n\n    valueToForm(m) {\n        var mode = this.getMode(m);\n        this.modes[mode].valueToForm();\n    }\n\n    resizeToContainer() {\n        // resize ace\n        if (this.modes.code) { this.modes.code.resize(); }\n    }\n\n    resizeToContent() {\n        // size to content\n        this.container.querySelector(\".\" + Editor.classes.editor.content).style.height = (this.textarea.rows * 1.5) + \"em\";\n\n        // resize ace\n        if (this.modes.code) { this.modes.code.resize(); }\n    }\n\n    // enter fullscreen\n    enterFullscreen() {\n        console.log(\"fullscreen\");\n        this.resizeToContainer();\n    }\n\n    // exit fullscreen\n    exitFullscreen() {\n        console.log(\"exit\");\n        console.trace();\n        this.resizeToContent();\n    }\n\n    handleSwitchEditor(event) {\n        console.log(\"Editor.handleSwitchEditor\");\n        var editorToSwitch = event.currentTarget.getAttribute(\"data-editor\");\n        this.hide();\n        return this.show(editorToSwitch);\n    }\n\n    handleFormSubmit() {\n        return this.valueToForm();\n    }\n}\n\nEditor.list = [];\nEditor.classes = {\n    editor: {\n        container: \"Editor\",\n        header: \"Editor-header\",\n        content: \"Editor-content\",\n        footer: \"Editor-footer\",\n        preview: \"Editor-preview\"\n    },\n    state: {\n        isHidden: \"Editor--hidden\",\n        contentIsSplit: \"Editor-content--isSplit\"\n    },\n    button: {\n        switchEditor: \"Editor--switchEditor\",\n        fullscreenToggle: \"Editor--toggleFullscreen\"\n    }\n};","// ================================\n//          PreviewInterface\n// ================================\n\nclass PreviewInterface {\n\n    constructor(editor) {\n        this.editor = editor;\n        this.view = null;\n    }\n\n    create() {\n        var preview = document.createElement(\"iframe\");\n        preview.id = this.editor.name + \"-preview\";\n        preview.classList.add(Editor.classes.editor.preview);\n        this.editor.container.querySelector(\".Editor-content\").appendChild(preview);\n        this.view = preview;\n    }\n\n    show(full) {\n        let preview = document.getElementById(this.editor.name + \"-preview\")\n        preview.classList.remove(Editor.classes.state.isHidden);\n\n        if (full) {\n            preview.style.width = \"100%\";\n        }\n    }\n\n    hide() {\n        return document.getElementById(this.editor.name + \"-preview\").classList.add(Editor.classes.state.isHidden);\n    }\n\n    valueFromForm() {\n        let data = {\n            _token: this.editor.container.querySelector(\".contentPreviewCSRFToken\").value,\n            content: this.editor.textarea.value\n        };\n        let url = this.editor.container.querySelector(\".contentPreviewURL\").value;\n        let method = this.editor.container.querySelector(\".contentPreviewMethod\").value;\n        console.log(\"Generating content using data \", data);\n        var promise = window.fetch(\n            url,\n            FetchOptions.default()\n                .method(method)\n                .body(getFormDataObject(data))\n        )\n            .then(Oxygen.respond.checkStatus)\n            .then(Oxygen.respond.text)\n            .then((data) => {\n                this.view.srcdoc = data;\n            })\n            // this particular endpoint returns an HTML error page, so we provide a custom handler.\n            .catch((error) => {\n                if(error.response && error.response instanceof Response) {\n                    console.error(error);\n                    error.response.text().then((data) => {\n                        this.view.srcdoc = data;\n                    });\n                } else {\n                    throw error;\n                }\n            });\n    }\n\n    // we can't and don't want to do this\n    valueToForm() {}\n}\n","// ==========================\n//     SplitViewInterface\n// ==========================\n\nclass SplitViewInterface {\n\n    constructor(editor) {\n        this.editor = editor;\n        this.view = null;\n    }\n\n    create() {\n    }\n\n    show() {\n        var items = this.editor.container.querySelectorAll(\".\" + Editor.classes.editor.content);\n        for(let item of items) {\n            item.classList.add(Editor.classes.state.contentIsSplit);\n        }\n\n        var e = this.editor;\n\n        e.show(\"code\", false);\n        e.show(\"preview\", false);\n        e.modes.code.view.style.width = \"50%\";\n        e.modes.preview.view.style.width = \"50%\";\n        e.modes.code.ace.addEventListener(\"change\", this.synchronize.bind(this));\n    }\n\n    hide() {\n        var items = this.editor.container.querySelectorAll(\".\" + Editor.classes.editor.content);\n        for(let item of items) {\n            item.classList.remove(Editor.classes.state.contentIsSplit);\n        }\n\n        this.editor.hide(\"code\");\n        this.editor.hide(\"preview\");\n    }\n\n    valueFromForm() {\n    }\n\n    valueToForm() {\n    }\n\n    synchronize() {\n        if(this.currentTimer) {\n            clearTimeout(this.currentTimer);\n        }\n        this.currentTimer = setTimeout(() => {\n            if(this.editor.currentMode === \"split\") {\n                this.editor.valueToForm(\"code\");\n                this.editor.valueFromForm(\"preview\");\n            }\n        }, 1000);\n    }\n}\n","// ================================\n//             ImageEditor\n// ================================\n\nclass ImageEditor {\n\n    // -----------------\n    //      Object\n    // -----------------\n\n    constructor(container) {\n        this.container = container;\n        this.jCropApi = null;\n        this.cropDisableCounter = 0;\n        this.cropOrigin = { x: 0, y: 0 };\n        this.image = this.container.querySelector(\".\" + ImageEditor.classes.layout.image);\n        this.$image = $(this.image);\n        if (!this.image) { throw new Error(\"<img> element doesn't exist\"); }\n\n        this.forms = {\n            simple: this.image.parentNode.parentNode.querySelector(\".\" + ImageEditor.classes.form.simple),\n            advanced: this.image.parentNode.parentNode.querySelector(\".\" + ImageEditor.classes.form.advanced)\n        };\n\n        this.fields = {\n            crop: {\n                x: this.container.querySelector('[name=\"crop[x]\"]'),\n                y: this.container.querySelector('[name=\"crop[y]\"]'),\n                width: this.container.querySelector('[name=\"crop[width]\"]'),\n                height: this.container.querySelector('[name=\"crop[height]\"]')\n            },\n            resize: {\n                width: this.container.querySelector('[name=\"resize[width]\"]'),\n                height: this.container.querySelector('[name=\"resize[height]\"]'),\n                keepAspectRatio: this.container.querySelector('[name=\"resize[keepAspectRatio]\"][value=\"true\"]')\n            },\n            macro: this.container.querySelector('[name=\"macro\"]'),\n            name: this.container.querySelector('[name=\"name\"]'),\n            slug: this.container.querySelector('[name=\"slug\"]')\n        };\n\n        this.image.addEventListener(\"load\", (event) => {\n            console.log('Image Loaded');\n            let image = event.currentTarget;\n            this.imageAspectRatio = image.naturalWidth / image.naturalHeight;\n            this.fields.resize.width.value = image.naturalWidth;\n            this.fields.resize.height.value = image.naturalHeight;\n            this.enableCropping();\n        });\n\n        this.fullscreenToggle = new FullscreenToggle(this.container.querySelector(\".\" + ImageEditor.classes.button.toggleFullscreen), this.container);\n\n        this.container.querySelector(\".\" + ImageEditor.classes.button.apply).addEventListener(\"click\", this.handlePreview.bind(this));\n        this.container.querySelector(\".\" + ImageEditor.classes.button.save).addEventListener(\"click\", this.handleSave.bind(this));\n        this.container.querySelectorAll(\".\" + ImageEditor.classes.form.crop).forEach(item => {\n            item.addEventListener(\"input\", this.handleCropInputChange.bind(this));\n        })\n        this.container.querySelectorAll(\".\" + ImageEditor.classes.form.resize).forEach(item => {\n            item.addEventListener(\"input\", this.handleResizeInputChange.bind(this));\n        })\n    }\n\n    handlePreview() {\n        this.applyChanges(this.gatherData());\n    }\n\n    handleSave() {\n        var data = this.gatherData();\n        data.save = true;\n        data.name = this.fields.name.value;\n        data.slug = this.fields.slug.value;\n        this.applyChanges(data);\n\n        this.progressNotification = new Notification({\n            content: \"Saving Image\",\n            status: \"success\"\n        });\n        NotificationCenter.present(this.progressNotification);\n    }\n\n    gatherData() {\n        var mode = TabSwitcher.list[0].current;\n        switch (mode) {\n            case \"simple\": return this.getSimpleData();\n            case \"advanced\": return this.getAdvancedData();\n            default: return {};\n        }\n    }\n\n    getSimpleData() {\n        return this.removeDefaultFields(getFormData(this.forms.simple));\n    }\n\n    removeDefaultFields(formData) {\n        var resize = (formData) => {\n            return (!formData[\"resize[width]\"] || formData[\"resize[width]\"] === this.image.naturalWidth.toString()) &&(!formData[\"resize[height]\"] || formData[\"resize[height]\"] === this.image.naturalHeight.toString());\n        };\n\n        var defaults = {\n            \"fit[position]\": (item) => {\n                return item === \"center\";\n            },\n            \"resize[width]\": (item, formData) => {\n                return resize(formData);\n            },\n            \"resize[height]\": (item, formData) => {\n                return resize(formData);\n            },\n            \"resize[keepAspectRatio]\": (item, formData) => {\n                return resize(formData);\n            },\n            \"gamma\": (item) => {\n                return item === \"1\";\n            },\n            \"greyscale\": (item) => {\n                return item === \"false\";\n            },\n            \"invert\": (item) => {\n                return item === \"false\";\n            },\n            \"rotate[backgroundColor]\": (item) => {\n                return item === \"#ffffff\";\n            },\n            \"crop[x]\": (item) => {\n                //return item === \"\"  0 : parseInt(item)\n                if(this.pendingCropOrigin === undefined) { this.pendingCropOrigin = {}; }\n                this.pendingCropOrigin.x = parseInt(item);\n            },\n            \"crop[y]\": (item) => {\n                if(this.pendingCropOrigin === undefined) { this.pendingCropOrigin = {}; }\n                this.pendingCropOrigin.y = parseInt(item);\n                //this.imageDimensions.cropY = item === \"\" ? 0 : parseInt(item);\n            }\n        };\n\n        for (var key in formData) {\n            var item = formData[key];\n            if(defaults[key] && defaults[key](item, formData)) {\n                delete formData[key];\n            } else if(item === \"0\" || item === \"\") {\n                delete formData[key];\n            }\n        }\n\n        return formData;\n    }\n\n    getAdvancedData() {\n        return JSON.parse(this.fields.macro.value);\n    }\n\n    // --------------------------------------------\n    //                     REQUEST\n    // --------------------------------------------\n\n    applyChanges(data) {\n        if(this.applyingChanges) {\n            NotificationCenter.present(new Notification({\n                content: \"Already Processing\",\n                status: \"failed\"\n            }));\n            return;\n        }\n\n        this.applyingChanges = true;\n\n        console.log(\"Processing Image Using Commands: \", data);\n\n        var url = this.image.getAttribute(\"data-root\") + \"?\" + serializeToQueryString(data);\n        var headers = new Headers();\n        headers.set(\"Accept\", \"application/json\");\n        var options = {\n            method: \"GET\",\n            credentials: \"same-origin\",\n            headers: headers\n        };\n\n        console.log(\"Requesting URL: \", url, options);\n\n        window.fetch(url, options)\n            .then(Oxygen.respond.checkStatus)\n            .then(response => {\n                return response.blob();\n            })\n            .then(myBlob => {\n                if ((this.jCropApi != null)) { this.jCropApi.destroy(); }\n                this.jCropApi = null;\n                this.cropOrigin = this.pendingCropOrigin;\n\n                let objectURL = URL.createObjectURL(myBlob);\n                this.image.style.removeProperty('width');\n                this.image.style.removeProperty('height');\n                this.image.src = objectURL;\n\n                //this.image[0].src = \"data:image/jpeg;base64,\" + base64Encode(response);\n            })\n            .then(\n                r => {\n                    NotificationCenter.present(new Notification({content: \"Image Processing Successful\", status: \"success\"}));\n                    this.applyingChanges = false;\n                },\n                e => {\n                    this.applyingChanges = false; throw e;\n                }\n            )\n            .catch(Oxygen.respond.handleAPIError);\n        /*$.ajax({\n            type:           \"GET\",\n            url:            this.image.attr(\"data-root\"),\n            data:           data,\n            contentType:    false,\n            success:        this.onRequestEnd.bind(this),\n            error:          () => {\n                //this.progressNotification.hide();\n                //return Ajax.handleError();\n            },\n            xhr:            () => {\n                var object = window.ActiveXObject ? new ActiveXObject(\"XMLHttp\") : new XMLHttpRequest();\n                object.overrideMimeType(\"text/plain; charset=x-user-defined\");\n                return object;\n            }\n        });*/\n    }\n\n    // --------------------------------------------\n    //                     CROP\n    // --------------------------------------------\n\n    enableCropping() {\n        /*if(this.jCropApi != null) {\n            this.jCropApi.enable();\n        } else {*/\n            var that = this;\n            this.$image.Jcrop({\n                    trueSize: [this.image.naturalWidth, this.image.naturalHeight],\n                    onChange: this.handleCropSelect.bind(this),\n                    onSelect: this.handleCropSelect.bind(this),\n                    onRelease: this.handleCropRelease.bind(this)\n                }, function() {\n                    that.jCropApi = this;\n                }\n            );\n        //}\n    }\n\n    handleCropSelect(c) {\n        if(this.cropDisableCounter <= 0) {\n            this.fields.crop.x.value = Math.round(c.x + this.cropOrigin.x).toString();\n            this.fields.crop.y.value = Math.round(c.y + this.cropOrigin.y).toString();\n            this.fields.crop.width.value = Math.round(c.w).toString();\n            this.fields.crop.height.value = Math.round(c.h).toString();\n        } else {\n            this.cropDisableCounter--;\n        }\n    }\n\n    handleCropInputChange(event) {\n        if(this.jCropApi === null) { return; }\n        let x = parseInt(this.fields.crop.x.value === \"\" ? 0 : this.fields.crop.x.value);\n        let y = parseInt(this.fields.crop.y.value === \"\" ? 0 : this.fields.crop.y.value);\n        let w = parseInt(this.fields.crop.width.value === \"\" ? 0 : this.fields.crop.width.value);\n        let h = parseInt(this.fields.crop.height.value === \"\" ? 0 : this.fields.crop.height.value);\n\n        // this counts down from 2, so the next two events generated by Jcrop are ignored.\n        this.cropDisableCounter = 2;\n\n        return this.jCropApi.setSelect([\n            x,\n            y,\n            x + w,\n            y + h\n        ]);\n    }\n\n    handleCropRelease() {\n        this.fields.crop.x.value = 0;\n        this.fields.crop.y.value = 0;\n        this.fields.crop.width.value = 0;\n        this.fields.crop.height.value = 0;\n    }\n\n    handleResizeInputChange(e) {\n        if(this.fields.resize.keepAspectRatio[0].checked) {\n            var name = e.target.name;\n            var value = e.target.value;\n            console.log(name, value);\n            if(name === 'resize[width]') {\n                return this.fields.resize.height.value = Math.round(value / this.imageAspectRatio);\n            } else {\n                return this.fields.resize.width.value = Math.round(value * this.imageAspectRatio.ratio);\n            }\n        }\n    }\n\n    static initialize(container) {\n        for(let item of container.querySelectorAll(\".\" + ImageEditor.classes.layout.container)) {\n            ImageEditor.list.push(new ImageEditor(item));\n        }\n    }\n\n};\n\nfunction serializeToQueryString(object) {\n    return Object.keys(object).reduce(function(a,k){a.push(k+'='+encodeURIComponent(object[k]));return a},[]).join('&');\n}\n\nImageEditor.list = [];\n\nImageEditor.classes = {\n    layout: {\n        container: \"ImageEditor\",\n        image: \"ImageEditor-image\"\n    },\n    button: {\n        toggleFullscreen: \"ImageEditor-toggleFullscreen\",\n        save: \"ImageEditor-save\",\n        apply: \"ImageEditor-apply\"\n    },\n    form: {\n        simple: \"ImageEditor-form--simple\",\n        advanced: \"ImageEditor-form--advanced\",\n        crop: \"ImageEditor-crop-input\",\n        resize: \"ImageEditor-resize-input\"\n    }\n};\n","Oxygen || (Oxygen = {});\nOxygen.initLogin = function() {\n    var loginForm = document.querySelector(\".Login-form\");\n    loginForm.classList.add(\"Login--noTransition\");\n    loginForm.classList.add(\"Login--slideDown\");\n\n    loginForm.offsetHeight;\n    loginForm.classList.remove(\"Login--noTransition\");\n\n    setTimeout(function() {\n        document.body.classList.remove(\"Login--isHidden\");\n    }, 500);\n\n    document.querySelector(\".Login-scrollDown\").addEventListener(\"click\", function() {\n        document.querySelector(\".Login-message\").classList.add(\"Login--slideUp\");\n        loginForm.classList.remove(\"Login--slideDown\");\n        document.querySelector(\".Login-background--blur\").classList.add(\"Login--isHidden\");\n    });\n\n    let form = loginForm.querySelector(\"form\");\n\n    form.addEventListener(\"submit\", function() {\n        loginForm.classList.add(\"Login--slideUp\");\n    });\n\n    form.modifyPromise = function(promise) {\n        return promise.then(\n            function(data) {\n                if(data.status !== undefined && data.status !== \"success\") {\n                    loginForm.classList.remove(\"Login--slideUp\");\n                }\n                return data;\n            },\n            function(error) {\n                loginForm.classList.remove(\"Login--slideUp\");\n                throw error;\n            }\n        );\n    };\n};\n","window.Oxygen || (window.Oxygen = {});\nOxygen.reset = function() {\n    window.editors = [];\n    Oxygen.load = [];\n    Oxygen.setBodyScrollable(true);\n    return Dropdown.handleGlobalClick({ target: document.body });\n};\n\nOxygen.setBodyScrollable = function(scrollable) {\n    if (scrollable) {\n        document.body.classList.remove(\"Body--noScroll\");\n    } else {\n        document.body.classList.add(\"Body--noScroll\");\n    }\n};\n\nOxygen.init = function(container) {\n\n    //\n    // -------------------------\n    //       FLASH MESSAGE\n    // -------------------------\n    //\n    // This small delay helps to\n    // reduce lag on page load.\n    //\n\n    NotificationCenter.initializeExistingMessages();\n\n    Dialog.registerEvents(container);\n\n    //\n    // -------------------------\n    //       IMAGE EDITOR\n    // -------------------------\n    //\n    // Initialises image editors for the page.\n    //\n\n    ImageEditor.initialize(container);\n\n    //\n    // -------------------------\n    //           LOGIN\n    // -------------------------\n    //\n    // Login form animations.\n    //\n\n    if(document.querySelector(\".Login-form\")) {\n        Oxygen.initLogin();\n    }\n\n    //\n    // -------------------------\n    //           OTHER\n    // -------------------------\n    //\n    // Other event handlers.\n    //\n\n    Dropdown.registerEvents(container);\n    EditableList.registerEvents(container);\n    Form.findAll(container);\n    Upload.registerEvents(container);\n    TabSwitcher.findAll(container);\n    Slider.findAll(container);\n\n    //\n    // -------------------------\n    //       CODE EDITOR\n    // -------------------------\n    //\n    // Initialises code editors for the page.\n    //\n\n    if ((typeof editors !== \"undefined\" && editors !== null)) {\n        Editor.createEditors(editors);\n    }\n\n    let load = Oxygen.load || [];\n    for (let i = 0, callback; i < load.length; i++) {\n        callback = load[i];\n        callback();\n    }\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n    MainNav.headroom();\n\n    if ((typeof user !== \"undefined\" && user !== null)) {\n        Preferences.setPreferences(user);\n    }\n\n    Oxygen.init(document);\n\n    if (Preferences.get('pageLoad.smoothState.enabled', true) === true) {\n        console.log(\"smoothstate enabled\");\n        window.smoothState = new SmoothState();\n        SmoothState.setTheme(Preferences.get('pageLoad.smoothState.theme', 'slide'));\n    } else {\n        console.log(\"smoothstate disabled\");\n    }\n\n    let progressThemes = Preferences.get('pageLoad.progress.theme', [\"minimal\", \"spinner\"]);\n    console.log(\"Applying progress themes:\", progressThemes);\n    for (let i = 0, theme; i < progressThemes.length; i++) {\n        theme = progressThemes[i];\n        document.body.classList.add(\"Page-progress--\" + theme);\n    }\n\n    Form.registerKeydownHandler();\n    Dropdown.registerGlobalEvent();\n});\n"]}